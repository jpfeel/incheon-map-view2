<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ì¸ì²œ 3-Active ì„±ê³¼ ë¶„ì„ ë¦¬í¬íŠ¸</title>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <style>
    /* ----- ìŠ¤íƒ€ì¼ (ë””ìì¸) ì˜ì—­ ----- */
    :root {
        --primary: #0f172a;       
        --accent: #2563eb;        
        --success: #10b981;       
        --warning: #f59e0b;       
        --bg-light: #f1f5f9;      
        --text-main: #334155;     
        --text-sub: #64748b;      
        --border: #e2e8f0;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    body, html { 
        width: 100%; height: 100%; margin: 0; padding: 0; 
        font-family: 'Noto Sans KR', sans-serif; 
        background-color: var(--bg-light); 
        color: var(--text-main);
        overflow: hidden; 
    }
    
    .container { display: flex; width: 100%; height: 100%; }
    
    /* ì™¼ìª½ ì§€ë„ ì˜ì—­ */
    .map-area { width: 45%; height: 100%; position: relative; border-right: 1px solid var(--border); }
    #map { width: 100%; height: 100%; }
    
    /* ì˜¤ë¥¸ìª½ ëŒ€ì‹œë³´ë“œ ì˜ì—­ */
    .dashboard-area { width: 55%; height: 100%; display: flex; flex-direction: column; background: #fff; }

    /* ì§€ë„ ë§ˆì»¤ ìŠ¤íƒ€ì¼ */
    .dot-node { width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); cursor: pointer; transition: 0.2s; }
    .dot-node:hover { transform: scale(1.4); }
    
    .label-overlay {
      background: rgba(255, 255, 255, 0.95); border-radius: 6px; border: 1px solid var(--border);
      padding: 3px 8px; font-size: 11px; font-weight: 800; color: var(--primary); margin-top: -12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); white-space: nowrap;
    }

    .legend {
      position: absolute; top: 20px; left: 20px; z-index: 999;
      background: rgba(255, 255, 255, 0.98); padding: 15px; border-radius: 8px;
      box-shadow: var(--shadow); border: 1px solid var(--border);
    }
    .legend h3 { margin: 0 0 10px 0; font-size: 14px; font-weight: 800; color: var(--primary); }
    .legend-item { margin-bottom: 5px; font-size: 12px; display: flex; align-items: center; color: var(--text-sub); }
    .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 8px; }

    /* í—¤ë” */
    .header { padding: 20px 30px; border-bottom: 1px solid var(--border); background: #fff; }
    .title-row { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px; }
    .main-title { font-size: 22px; font-weight: 900; color: var(--primary); letter-spacing: -0.5px; margin: 0; }
    .sub-title { font-size: 13px; color: var(--text-sub); margin: 4px 0 0; }
    
    .data-badges span { 
        font-size: 10px; font-weight: 700; color: var(--text-sub); 
        background: var(--bg-light); padding: 4px 8px; border-radius: 4px; margin-left: 4px; 
    }

    /* KPI ì¹´ë“œ */
    .kpi-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
    .kpi-card {
        background: linear-gradient(135deg, #f8fafc 0%, #eff6ff 100%);
        border: 1px solid #dae4f3; border-radius: 8px; padding: 15px 20px;
        position: relative; transition: transform 0.2s;
    }
    .kpi-card:hover { transform: translateY(-2px); border-color: var(--accent); }
    .kpi-label { font-size: 11px; font-weight: 700; color: var(--text-sub); text-transform: uppercase; display: block; margin-bottom: 5px; }
    .kpi-val { font-size: 24px; font-weight: 900; color: var(--accent); }
    .kpi-unit { font-size: 12px; font-weight: 600; color: var(--text-sub); margin-left: 2px; }
    .kpi-icon { position: absolute; right: 15px; top: 15px; font-size: 20px; color: #cbd5e1; }

    /* íƒ­ */
    .tab-nav { display: flex; padding: 0 30px; background: #fff; border-bottom: 1px solid var(--border); margin-top: 10px; }
    .tab-btn {
        padding: 12px 20px; font-size: 14px; font-weight: 600; color: var(--text-sub);
        border: none; background: none; cursor: pointer; border-bottom: 3px solid transparent;
        transition: all 0.2s;
    }
    .tab-btn:hover { color: var(--accent); background: var(--bg-light); }
    .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); font-weight: 800; }

    /* ì½˜í…ì¸  */
    .content { flex: 1; overflow-y: auto; padding: 25px 30px; background: var(--bg-light); }
    .tab-pane { display: none; animation: fadeIn 0.4s; }
    .tab-pane.active { display: block; }
    
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* ë¶„ì„ ë°•ìŠ¤ */
    .insight-box {
        background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px;
        border-left: 5px solid var(--primary); box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        border: 1px solid var(--border); border-left-width: 5px;
    }
    .insight-header { display: flex; align-items: center; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px dashed var(--border); }
    .insight-title { font-size: 15px; font-weight: 800; color: var(--primary); margin-left: 8px; }
    .insight-body { font-size: 13px; color: var(--text-main); line-height: 1.6; display: grid; grid-template-columns: 1fr; gap: 8px; }
    
    .tag { 
        display: inline-block; padding: 2px 6px; border-radius: 4px; 
        font-size: 10px; font-weight: 700; color: white; margin-right: 6px; vertical-align: middle;
    }
    .tag-tel { background: #e11d48; } 
    .tag-card { background: #d97706; } 
    .tag-med { background: #059669; } 

    /* ì°¨íŠ¸ ì¹´ë“œ */
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
    .card { 
        background: white; border-radius: 10px; padding: 20px; 
        box-shadow: var(--shadow); border: 1px solid var(--border); 
        display: flex; flex-direction: column;
    }
    .full { grid-column: span 2; }
    
    .card-head { 
        font-size: 15px; font-weight: 700; color: var(--primary); 
        margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--bg-light);
        display: flex; justify-content: space-between; align-items: center;
    }
    
    .card-footer {
        margin-top: 15px; padding: 12px; background: #f0f9ff; border-radius: 6px;
        font-size: 13px; color: #0369a1; font-weight: 700; text-align: center;
        border: 1px solid #bae6fd; display: flex; align-items: center; justify-content: center; gap: 5px;
    }
    
    .chart-container { position: relative; height: 250px; width: 100%; }

    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
  </style>
</head>
<body>

<div class="container">
  <div class="map-area">
      <div id="map"></div>
      <div class="legend">
        <h3>INCHEON 3-ACTIVE</h3>
        <div class="legend-item"><span class="dot" style="background:#2ecc71;"></span>ê±°ì  ë„ì„œê´€ (Hub)</div>
        <div class="legend-item"><span class="dot" style="background:#e74c3c;"></span>Cold Spot (ì§€ì›í•„ìš”)</div>
        <div class="legend-item"><span class="dot" style="background:#3498db;"></span>ì°¸ì—¬ í•™êµ (School)</div>
        <div class="legend-item"><span class="dot" style="background:#f39c12;"></span>í˜‘ë ¥ ì„œì  (Store)</div>
      </div>
  </div>

  <div class="dashboard-area">
      
      <div class="header">
          <div class="title-row">
              <div>
                  <h1 class="main-title">3-Active ì„±ê³¼ ë¶„ì„ ë¦¬í¬íŠ¸</h1>
                  <p class="sub-title">í†µì‹ Â·ì¹´ë“œÂ·ì˜ë£Œ ë°ì´í„° ê²°í•© ê¸°ë°˜ êµìœ¡ íš¨ê³¼ì„± ê²€ì¦</p>
              </div>
              <div class="data-badges">
                  <span>KTí†µì‹ </span><span>ì‹ í•œì¹´ë“œ</span><span>KCBì˜ë£Œ</span>
              </div>
          </div>
          
          <div class="kpi-row">
              <div class="kpi-card">
                  <span class="kpi-label">ë””ì§€í„¸ ë””í†¡ìŠ¤ ì´ëŸ‰</span>
                  <div><span class="kpi-val">48,200</span> <span class="kpi-unit">ì‹œê°„</span></div>
                  <i class="fas fa-mobile-alt kpi-icon"></i>
              </div>
              <div class="kpi-card">
                  <span class="kpi-label">ì˜¤í”„ë¼ì¸ ë˜ë˜í™œë™ ì¦ê°€</span>
                  <div><span class="kpi-val">+ 140</span> <span class="kpi-unit">%</span></div>
                  <i class="fas fa-user-friends kpi-icon"></i>
              </div>
              <div class="kpi-card">
                  <span class="kpi-label">ì‚¬íšŒì  ë¹„ìš©(ì˜ë£Œ) ì ˆê°</span>
                  <div><span class="kpi-val">15.3</span> <span class="kpi-unit">% â–¼</span></div>
                  <i class="fas fa-notes-medical kpi-icon"></i>
              </div>
          </div>
      </div>

      <div class="tab-nav">
          <button type="button" class="tab-btn active" onclick="openTab(event, 'tab1')">1. ì—¬ê°€ ìƒí™œ (Leisure)</button>
          <button type="button" class="tab-btn" onclick="openTab(event, 'tab2')">2. ì‚¬íšŒ ìƒí™œ (Social)</button>
          <button type="button" class="tab-btn" onclick="openTab(event, 'tab3')">3. ê±´ê°• ìƒí™œ (Health)</button>
      </div>

      <div class="content">
          
          <div id="tab1" class="tab-pane active">
              <div class="insight-box" style="border-left-color: #2563eb;">
                  <div class="insight-header">
                      <i class="fas fa-gamepad" style="color:#2563eb; margin-right:8px;"></i>
                      <span class="insight-title" style="color:#2563eb;">ë””ì§€í„¸ ê³¼ëª°ì… í•´ì†Œ & ì—¬ê°€ ì§ˆì  ê°œì„ </span>
                  </div>
                  <div class="insight-body">
                      <div><span class="tag tag-tel">í†µì‹ </span> <strong>ê±´ì „ ì—¬ê°€ ì ìœ ìœ¨:</strong> PCë°©(ìˆ˜ë™ì ) vs ë„ì„œê´€/ì²´ìœ¡ê´€(ëŠ¥ë™ì ) ì²´ë¥˜ ì‹œê°„ ë¹„ìœ¨ ë¹„êµ</div>
                      <div><span class="tag tag-card">ì¹´ë“œ</span> <strong>ë¬¸í™” ì†Œë¹„ ë‹¤ì–‘ì„±:</strong> ì˜í™”ê´€ í¸ì¤‘ ì†Œë¹„ â†’ ì„œì /ì „ì‹œ/ê³µì—° ë“± ë¬¸í™” ì¹´í…Œê³ ë¦¬ í™•ì¥ì„±</div>
                  </div>
              </div>

              <div class="grid-2">
                  <div class="card">
                      <div class="card-head">ë””ì§€í„¸ ê³¼ëª°ì… í•´ì†Œ (Healthy Place Share)</div>
                      <div class="chart-container"><canvas id="chartHealthyPlace"></canvas></div>
                      <div class="card-footer">ğŸ“‰ PCë°© ì²´ë¥˜ 50% ê°ì†Œ / ğŸ“ˆ ë„ì„œê´€Â·ì²´ìœ¡ê´€ 2ë°° ì¦ê°€</div>
                  </div>
                  <div class="card">
                      <div class="card-head">ì—¬ê°€ ëª°ì…ë„ (Deep Stay Rate)</div>
                      <div class="chart-container"><canvas id="chartDeepStay"></canvas></div>
                      <div class="card-footer">âœ¨ 2ì‹œê°„ ì´ìƒ 'ëª°ì… í™œë™' ë¹„ìœ¨ ëŒ€í­ ìƒìŠ¹</div>
                  </div>
              </div>
              <div class="card">
                  <div class="card-head">ë¬¸í™” ì†Œë¹„ ì¹´í…Œê³ ë¦¬ ë‹¤ì–‘ì„± (Culture Entropy)</div>
                  <div class="chart-container"><canvas id="chartEntropy"></canvas></div>
              </div>
          </div>

          <div id="tab2" class="tab-pane">
              <div class="insight-box" style="border-left-color: #f59e0b;">
                  <div class="insight-header">
                      <i class="fas fa-users" style="color:#f59e0b; margin-right:8px;"></i>
                      <span class="insight-title" style="color:#f59e0b;">ê³ ë¦½ì—ì„œ ì†Œí†µìœ¼ë¡œ (Social Interaction)</span>
                  </div>
                  <div class="insight-body">
                      <div><span class="tag tag-tel">í†µì‹ </span> <strong>ê³µê³µ ì»¤ë®¤ë‹ˆí‹° ë„ë‹¬ë¥ :</strong> í•™êµ-ì§‘ ê²½ë¡œ ì™¸ ê³µê³µì‹œì„¤(ì£¼ë¯¼ì„¼í„° ë“±) ë°©ë¬¸ íŠ¸ë˜í”½ ë¶„ì„</div>
                      <div><span class="tag tag-card">ì¹´ë“œ</span> <strong>ë˜ë˜ ë¬¸í™” í™œë™ ì§€ìˆ˜(Social Play):</strong> 'ì˜¨ë¼ì¸ ê²Œì„(ê³ ë¦½)' vs 'ì˜¤í”„ë¼ì¸ í¬í† /ë…¸ë˜ë°©(êµë¥˜)' ì†Œë¹„ íŒ¨í„´ ë¹„êµ</div>
                  </div>
              </div>

              <div class="card" style="margin-bottom: 20px;">
                  <div class="card-head">ì§€ì—­ì‚¬íšŒ ì°¸ì—¬ í™œë™ ì¦ê°€ (Civic Engagement)</div>
                  <div class="chart-container" style="height:150px;"><canvas id="chartCivic"></canvas></div>
              </div>

              <div class="grid-2">
                  <div class="card">
                      <div class="card-head">
                        <span>ë˜ë˜ ë¬¸í™” í™œë™ (Peer Social Activity)</span>
                        <i class="fas fa-user-friends" style="color:#f59e0b;"></i>
                      </div>
                      <div class="chart-container"><canvas id="chartSocialPlay"></canvas></div>
                      <div class="card-footer" style="color:#b45309; background:#fffbeb; border-color:#fef3c7;">
                          ğŸ¤ ê³ ë¦½í˜•(ê²Œì„) ì†Œë¹„ â–¼ <strong>êµë¥˜í˜•(ì‚¬ì§„/ì²´í—˜) ì†Œë¹„ â–²</strong>
                      </div>
                  </div>
                  
                  <div class="card">
                      <div class="card-head">ë¡œì»¬ ì°©í•œ ì†Œë¹„ (Local Value Spend)</div>
                      <div class="chart-container"><canvas id="chartLocalSpend"></canvas></div>
                      <div class="card-footer" style="color:#b45309; background:#fffbeb; border-color:#fef3c7;">
                          ğŸ˜ï¸ ëŒ€í˜•ë§ˆíŠ¸ë³´ë‹¤ ìš°ë¦¬ ë™ë„¤ ì†Œìƒê³µì¸ ê°€ê²Œ ì´ìš© ì¦ê°€
                      </div>
                  </div>
              </div>
          </div>

          <div id="tab3" class="tab-pane">
              <div class="insight-box" style="border-left-color: #10b981;">
                  <div class="insight-header">
                      <i class="fas fa-heartbeat" style="color:#10b981; margin-right:8px;"></i>
                      <span class="insight-title" style="color:#10b981;">ì‹ ì²´/ì •ì‹  ê±´ê°• ì¦ì§„ íš¨ê³¼</span>
                  </div>
                  <div class="insight-body">
                      <div><span class="tag tag-med">ì˜ë£Œ</span> <strong>ì˜ë£Œë¹„ ì—­ìƒê´€ ë¶„ì„:</strong> í™œë™ëŸ‰ ì¦ê°€ì™€ ì•ˆê³¼/ì •í˜•ì™¸ê³¼(ìŠ¤ë§ˆíŠ¸í° ì§ˆí™˜) ì§„ë£Œë¹„ ê°„ì˜ ìƒê´€ê´€ê³„</div>
                      <div><span class="tag tag-tel">í†µì‹ </span> <strong>í™œë™ ë°˜ê²½(Radius):</strong> ì§‘ ì¤‘ì‹¬ ì¢Œì‹ ìƒí™œ(Sedentary) íƒˆí”¼ ì—¬ë¶€ ë° ì´ë™ ê±°ë¦¬ ì¸¡ì •</div>
                  </div>
              </div>

              <div class="card">
                  <div class="card-head">í™œë™ëŸ‰ ì¦ê°€ì— ë”°ë¥¸ ë§Œì„±ì§ˆí™˜ ì˜ë£Œë¹„ ê°ì†Œ íš¨ê³¼</div>
                  <div class="chart-container" style="height: 300px;"><canvas id="chartMedical"></canvas></div>
                  <div class="card-footer" style="color:#065f46; background:#ecfdf5; border-color:#a7f3d0;">
                      ğŸ“‰ í™œë™ ì§€ìˆ˜ê°€ ë†’ì•„ì§ˆìˆ˜ë¡, ê´€ë ¨ ì˜ë£Œë¹„ ì§€ì¶œì€ ëšœë ·í•˜ê²Œ ê°ì†Œí•¨ (ìƒê´€ê³„ìˆ˜ -0.82)
                  </div>
              </div>
          </div>

      </div>
  </div>
</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=a355516d451bb52744d83c5763eb1560"></script>

<script>
// 1. ì§€ë„ ì´ˆê¸°í™” ë° ë°ì´í„°
kakao.maps.load(function () {
    var mapContainer = document.getElementById('map');
    var mapOption = { center: new kakao.maps.LatLng(37.50, 126.68), level: 9 };
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // ë°ì´í„°ì…‹
    var hubs = [
        {"name": "ë¶êµ¬ë„ì„œê´€", "lat": 37.5066218, "lng": 126.7230735, "type": "Hub", "region": "ë¶€í‰ê¶Œ"},
        {"name": "ë¶€í‰ë„ì„œê´€", "lat": 37.4849744, "lng": 126.7045964, "type": "Hub", "region": "ë¶€í‰ê¶Œ"},
        {"name": "ê³„ì–‘ë„ì„œê´€", "lat": 37.5459641, "lng": 126.7301965, "type": "Hub", "region": "ê³„ì–‘ê¶Œ"},
        {"name": "ì„œêµ¬ë„ì„œê´€", "lat": 37.4943306, "lng": 126.6796541, "type": "Hub", "region": "ì„œêµ¬ê¶Œ"},
        {"name": "ì£¼ì•ˆë„ì„œê´€", "lat": 37.4554851, "lng": 126.6927471, "type": "Hub", "region": "ë¯¸ì¶”í™€ê¶Œ"},
        {"name": "ì¤‘ì•™ë„ì„œê´€", "lat": 37.4556557, "lng": 126.7025455, "type": "Hub", "region": "ë‚¨ë™ê¶Œ"},
        {"name": "ì—°ìˆ˜ë„ì„œê´€", "lat": 37.4178463, "lng": 126.6852658, "type": "Hub", "region": "ì—°ìˆ˜ê¶Œ"},
        {"name": "í™”ë„ì§„ë„ì„œê´€", "lat": 37.4817612, "lng": 126.6282561, "type": "Hub", "region": "ë™êµ¬ê¶Œ"},
        {"name": "ê°•í™”ë„ì„œê´€", "lat": 37.7488175, "lng": 126.4831844, "type": "Cold Spot", "region": "ê°•í™”ê¶Œ"}
    ];
    var schools = [
        {"name": "ë¶€í‰ì—¬ê³ ", "lat": 37.5005587, "lng": 126.7196623}, {"name": "ë¶€ê´‘ì¤‘", "lat": 37.5012607, "lng": 126.7368838},
        {"name": "ë¶€í‰ë™ì´ˆ", "lat": 37.4996601, "lng": 126.7237400}, {"name": "ë¶€í‰ê³ ", "lat": 37.5022465, "lng": 126.7275792},
        {"name": "ê³„ì‚°ê³ ", "lat": 37.5469338, "lng": 126.7296607}, {"name": "ì‘ì „ì¤‘", "lat": 37.5333644, "lng": 126.7295462},
        {"name": "ê°€ì¢Œê³ ", "lat": 37.4894556, "lng": 126.6808340}, {"name": "ê°€ë¦¼ê³ ", "lat": 37.4928274, "lng": 126.6812112},
        {"name": "ì²­ë¼ê³ ", "lat": 37.5369893, "lng": 126.6607886}, {"name": "êµ¬ì›”ì¤‘", "lat": 37.4553432, "lng": 126.7092909},
        {"name": "ì„ì •ì—¬ê³ ", "lat": 37.4686806, "lng": 126.6946944}, {"name": "ì¸ì²œì—¬ê³ ", "lat": 37.4222410, "lng": 126.6896458},
        {"name": "ì—°ìˆ˜ê³ ", "lat": 37.4114651, "lng": 126.6798641}, {"name": "ë°•ë¬¸ì—¬ê³ ", "lat": 37.3827092, "lng": 126.6660388},
        {"name": "í•™ìµê³ ", "lat": 37.4390469, "lng": 126.6633655}, {"name": "ì£¼ì•ˆë‚¨ì´ˆ", "lat": 37.4502383, "lng": 126.6854180},
        {"name": "ì œë¬¼í¬ê³ ", "lat": 37.4766308, "lng": 126.6239769}, {"name": "ì¸ì¼ì—¬ê³ ", "lat": 37.4779465, "lng": 126.6261618},
        {"name": "ê°•í™”ì—¬ê³ ", "lat": 37.7546656, "lng": 126.4789540}, {"name": "ê°‘ë£¡ì´ˆ", "lat": 37.7436611, "lng": 126.5029419}
    ];
    var bookstores = [
        {"name": "ë”ë¶ìŠ¤", "lat": 37.4897746, "lng": 126.7233082}, {"name": "ë‚®ì ê³¼ë°”ëŒ", "lat": 37.5086005, "lng": 126.7278369},
        {"name": "ì±…ë°©ì‚°ì±…", "lat": 37.5404568, "lng": 126.7190295}, {"name": "ì„¸ì¢…ë¬¸ê³ ", "lat": 37.4115479, "lng": 126.6786156},
        {"name": "ì—´ë‹¤ì±…ë°©", "lat": 37.4066529, "lng": 126.6714896}, {"name": "ìœ„ì¦ˆë¤ìŠ¤í€˜ì–´", "lat": 37.4250000, "lng": 126.6550000},
        {"name": "ë¯¸ë˜ë¬¸ê³ ", "lat": 37.4869218, "lng": 126.7391518}, {"name": "ì„œì ì•ˆì°©", "lat": 37.5349240, "lng": 126.6515736},
        {"name": "ë‚˜ë¹„ë‚ ë‹¤", "lat": 37.4728064, "lng": 126.6361411}, {"name": "í•œë¯¸ì„œì ", "lat": 37.4725453, "lng": 126.6366690},
        {"name": "ë‚˜ì¦Œë¬¸í„±", "lat": 37.4723723, "lng": 126.6373493}
    ];

    // ë§ˆì»¤ ìƒì„±
    hubs.forEach(h => {
        var color = (h.type === 'Cold Spot') ? '#ef4444' : '#10b981';
        new kakao.maps.CustomOverlay({
            map: map, position: new kakao.maps.LatLng(h.lat, h.lng),
            content: '<div class="dot-node" style="background:'+color+'; border-color:'+color+'"></div>', zIndex: 5
        });
        new kakao.maps.CustomOverlay({
            map: map, position: new kakao.maps.LatLng(h.lat, h.lng),
            content: '<div class="label-overlay">'+h.name+'</div>', yAnchor: 2.5, zIndex: 4
        });
    });
    schools.forEach(s => {
        new kakao.maps.CustomOverlay({ map: map, position: new kakao.maps.LatLng(s.lat, s.lng), content: '<div class="dot-node" style="background:#3b82f6; border-color:white; width:10px; height:10px;"></div>' });
    });
    bookstores.forEach(b => {
        new kakao.maps.CustomOverlay({ map: map, position: new kakao.maps.LatLng(b.lat, b.lng), content: '<div class="dot-node" style="background:#f59e0b; border-color:white; width:10px; height:10px;"></div>' });
    });
});

// 2. íƒ­ ì „í™˜ ë¡œì§
function openTab(evt, tabName) {
    evt.preventDefault();
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tab-pane");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].classList.remove("active");
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tab-btn");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    var target = document.getElementById(tabName);
    target.style.display = "block";
    setTimeout(() => target.classList.add("active"), 10);
    evt.currentTarget.className += " active";
}

// 3. ì°¨íŠ¸ ìƒì„±
Chart.defaults.font.family = "'Noto Sans KR', sans-serif";
Chart.defaults.color = '#64748b';
Chart.defaults.scale.grid.color = '#f1f5f9';

document.addEventListener("DOMContentLoaded", function() {

    // [Tab 1] ê±´ì „ ì—¬ê°€ ì ìœ ìœ¨ (Stacked)
    new Chart(document.getElementById('chartHealthyPlace'), {
        type: 'bar',
        data: {
            labels: ["ì‚¬ì—… ì‹œí–‰ ì „", "ì‚¬ì—… ì‹œí–‰ í›„"],
            datasets: [
                { label: 'PCë°©/ê²Œì„ (ìˆ˜ë™)', data: [70, 35], backgroundColor: '#94a3b8', borderRadius: 4 },
                { label: 'ë„ì„œê´€/ì²´ìœ¡ê´€ (ëŠ¥ë™)', data: [30, 65], backgroundColor: '#2563eb', borderRadius: 4 }
            ]
        },
        options: {
            indexAxis: 'y', responsive: true, maintainAspectRatio: false,
            scales: { x: { stacked: true, max: 100, grid: { display: false } }, y: { stacked: true, grid: { display: false } } }
        }
    });

    // [Tab 1] ì—¬ê°€ ëª°ì…ë„ (Bar)
    new Chart(document.getElementById('chartDeepStay'), {
        type: 'bar',
        data: {
            labels: ["ë„ì„œê´€", "ì„œì ", "ë¬¸í™”ì„¼í„°"],
            datasets: [
                { label: 'Before', data: [30, 20, 40], backgroundColor: '#cbd5e1', borderRadius: 4 },
                { label: 'After', data: [65, 55, 75], backgroundColor: '#2563eb', borderRadius: 4 }
            ]
        },
        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 100 } } }
    });

    // [Tab 1] ë¬¸í™” ë‹¤ì–‘ì„± (Radar)
    new Chart(document.getElementById('chartEntropy'), {
        type: 'radar',
        data: {
            labels: ["ì˜í™”", "ë„ì„œ", "ê³µì—°/ì „ì‹œ", "ìŠ¤í¬ì¸ ", "ì²´í—˜í™œë™"],
            datasets: [
                { label: 'ê¸°ì¡´ (ì˜í™” í¸ì¤‘)', data: [60, 10, 10, 10, 10], borderColor: '#94a3b8', backgroundColor: 'rgba(148, 163, 184, 0.2)', borderWidth: 2 },
                { label: '3-Active (ê· í˜•)', data: [30, 25, 20, 15, 10], borderColor: '#2563eb', backgroundColor: 'rgba(37, 99, 235, 0.2)', borderWidth: 2 }
            ]
        },
        options: { responsive: true, maintainAspectRatio: false, scales: { r: { suggestedMin: 0, suggestedMax: 60 } } }
    });

    // [Tab 2] ê³µê³µ ì»¤ë®¤ë‹ˆí‹° ë„ë‹¬ë¥  (Line)
    new Chart(document.getElementById('chartCivic'), {
        type: 'line',
        data: {
            labels: ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”"],
            datasets: [{
                label: 'ê³µê³µì‹œì„¤ ë°©ë¬¸ íŠ¸ë˜í”½', data: [120, 150, 300, 450, 520, 680],
                borderColor: '#f59e0b', backgroundColor: 'rgba(245, 158, 11, 0.1)', fill: true, tension: 0.4
            }]
        },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
    });

    // [Tab 2] ë˜ë˜ ë¬¸í™” í™œë™ (Stacked Bar) - ìˆ˜ì •ëœ ë…¼ë¦¬ ì ìš©
    new Chart(document.getElementById('chartSocialPlay'), {
        type: 'bar',
        data: {
            labels: ['ì‚¬ì—… ì „', 'ì‚¬ì—… í›„'],
            datasets: [
                { label: 'ì˜¨ë¼ì¸/ê°œì¸ (ê²Œì„)', data: [75, 25], backgroundColor: '#94a3b8', stack: 'Stack 0', borderRadius: 4 },
                { label: 'ì˜¤í”„ë¼ì¸/ë˜ë˜ (êµë¥˜)', data: [40, 60], backgroundColor: '#f59e0b', stack: 'Stack 0', borderRadius: 4 }
            ]
        },
        options: { 
            indexAxis: 'y', responsive: true, maintainAspectRatio: false,
            scales: { x: { stacked: true, max: 100 }, y: { stacked: true } } 
        }
    });

    // [Tab 2] ë¡œì»¬ ì†Œë¹„ (Doughnut)
    new Chart(document.getElementById('chartLocalSpend'), {
        type: 'doughnut',
        data: {
            labels: ['ëŒ€í˜• í”„ëœì°¨ì´ì¦ˆ', 'ë™ë„¤ ì†Œìƒê³µì¸'],
            datasets: [{ data: [40, 60], backgroundColor: ['#cbd5e1', '#f59e0b'] }]
        },
        options: { responsive: true, maintainAspectRatio: false, cutout: '75%', plugins: { legend: { position: 'bottom' } } }
    });

    // [Tab 3] ì˜ë£Œë¹„ ê°ì†Œ (Mixed)
    new Chart(document.getElementById('chartMedical'), {
        type: 'bar',
        data: {
            labels: ["24.1Q", "24.2Q", "24.3Q", "24.4Q", "25.1Q", "25.2Q"],
            datasets: [
                { 
                    label: 'í™œë™ ì§€ìˆ˜', data: [40, 45, 60, 75, 85, 95], 
                    type: 'line', borderColor: '#10b981', borderWidth: 3, order: 1, yAxisID: 'y' 
                },
                { 
                    label: 'ì˜ë£Œë¹„ ì§€ìˆ˜', data: [100, 98, 85, 70, 65, 55], 
                    backgroundColor: 'rgba(16, 185, 129, 0.2)', borderRadius: 4, order: 2, yAxisID: 'y1' 
                }
            ]
        },
        options: { 
            responsive: true, maintainAspectRatio: false,
            scales: {
                y: { title: { display: true, text: 'ì‹ ì²´í™œë™ ì§€ìˆ˜' }, position: 'left' },
                y1: { title: { display: true, text: 'ì˜ë£Œë¹„ ì§€ìˆ˜' }, position: 'right', grid: { drawOnChartArea: false } }
            }
        }
    });
});
</script>
</body>
</html>
